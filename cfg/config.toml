[build]
target = "./x86_64-theseus.json"

[target.'cfg(target_os = "theseus")']
rustflags = [
    "--emit=obj",
    "-C", "debuginfo=2",
    "-C", "code-model=large",
    "-C", "relocation-model=static",
    "-D", "unused-must-use",
    "-Z", "merge-functions=disabled",  # `=trampolines` also works
    "-Z", "share-generics=no",
    ### only necessary if we want stack frame pointers (in register RBX)
    # "-C", "force-frame-pointers=yes",
]


[unstable] #.'cfg(target_os = "theseus")'] #'cfg(target_os = "theseus")']
unstable-options = true
build-std = ["core", "alloc"]
build-std-features = ["compiler-builtins-mem"]

# [target.x86_64-theseus]
# rustflags = ["-C", "link-args=--sysroot=./tlibc/target/x86_64-theseus/release/"]
