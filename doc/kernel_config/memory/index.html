<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The basic virtual address ranges (virtual memory map) defined by Theseus."><title>kernel_config::memory - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-f40c346f39d9abc1.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="kernel_config" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0-nightly (065a1f5df 2023-06-21)" data-search-js="search-95c92dd01058facf.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../../static.files/main-190c35055d2a8300.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../kernel_config/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../kernel_config/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module memory</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#constants">Constants</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">kernel_config</a>::<wbr><a class="mod" href="#">memory</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/kernel_config/memory.rs.html#1-111">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>The basic virtual address ranges (virtual memory map) defined by Theseus.</p>
<p>Current P4 (top-level page table) mappings:</p>
<ul>
<li>511: kernel text sections.</li>
<li>510: recursive mapping for accessing the current P4 root page table frame.</li>
<li>509: kernel heap.</li>
<li>508: recursive mapping for accessing the P4 root page table frame
of an upcoming new page table.</li>
<li>507 down to 0: available for general usage.</li>
</ul>
</div></details><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.ADDRESSABILITY_PER_P4_ENTRY.html" title="constant kernel_config::memory::ADDRESSABILITY_PER_P4_ENTRY">ADDRESSABILITY_PER_P4_ENTRY</a></div><div class="desc docblock-short">Value: 512 GiB.</div></li><li><div class="item-name"><a class="constant" href="constant.BYTES_PER_ADDR.html" title="constant kernel_config::memory::BYTES_PER_ADDR">BYTES_PER_ADDR</a></div><div class="desc docblock-short">64-bit architecture results in 8 bytes per address.</div></li><li><div class="item-name"><a class="constant" href="constant.ENTRIES_PER_PAGE_TABLE.html" title="constant kernel_config::memory::ENTRIES_PER_PAGE_TABLE">ENTRIES_PER_PAGE_TABLE</a></div><div class="desc docblock-short">Value: 512.</div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_HEAP_INITIAL_SIZE.html" title="constant kernel_config::memory::KERNEL_HEAP_INITIAL_SIZE">KERNEL_HEAP_INITIAL_SIZE</a></div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_HEAP_MAX_SIZE.html" title="constant kernel_config::memory::KERNEL_HEAP_MAX_SIZE">KERNEL_HEAP_MAX_SIZE</a></div><div class="desc docblock-short">The kernel heap is allowed to grow to fill the entirety of its P4 entry.</div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_HEAP_P4_INDEX.html" title="constant kernel_config::memory::KERNEL_HEAP_P4_INDEX">KERNEL_HEAP_P4_INDEX</a></div><div class="desc docblock-short">Value: 509. The 509th entry is used for the kernel heap.</div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_HEAP_START.html" title="constant kernel_config::memory::KERNEL_HEAP_START">KERNEL_HEAP_START</a></div><div class="desc docblock-short">The higher-half heap gets the 512GB address range starting at the 509th P4 entry,
which is the slot right below the recursive P4 entry (510).
Actual value: 0o177777_775_000_000_000_0000, or 0xFFFF_FE80_0000_0000</div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_OFFSET.html" title="constant kernel_config::memory::KERNEL_OFFSET">KERNEL_OFFSET</a></div><div class="desc docblock-short">The virtual address where the initial kernel (the nano_core) is mapped to.
Actual value: 0xFFFFFFFF80000000 on x86_64.
i.e., the linear offset between physical memory and kernel memory.
So, for example, the VGA buffer will be mapped from 0xb8000 to 0xFFFFFFFF800b8000 (on x86_64).
This is -2GiB from the end of the 64-bit address space.</div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_STACK_SIZE_IN_PAGES.html" title="constant kernel_config::memory::KERNEL_STACK_SIZE_IN_PAGES">KERNEL_STACK_SIZE_IN_PAGES</a></div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_TEXT_P4_INDEX.html" title="constant kernel_config::memory::KERNEL_TEXT_P4_INDEX">KERNEL_TEXT_P4_INDEX</a></div><div class="desc docblock-short">Value: 511. The 511th entry is used (in part) for kernel text sections.</div></li><li><div class="item-name"><a class="constant" href="constant.KERNEL_TEXT_START.html" title="constant kernel_config::memory::KERNEL_TEXT_START">KERNEL_TEXT_START</a></div><div class="desc docblock-short">The kernel text region is where we load kernel modules. 
It starts at the 511th P4 entry and goes up until the KERNEL_OFFSET,
which is where the nano_core itself starts. 
Actual value on x86_64: 0o177777_777_000_000_000_0000, or 0xFFFF_FF80_0000_0000</div></li><li><div class="item-name"><a class="constant" href="constant.MAX_PAGE_NUMBER.html" title="constant kernel_config::memory::MAX_PAGE_NUMBER">MAX_PAGE_NUMBER</a></div></li><li><div class="item-name"><a class="constant" href="constant.MAX_VIRTUAL_ADDRESS.html" title="constant kernel_config::memory::MAX_VIRTUAL_ADDRESS">MAX_VIRTUAL_ADDRESS</a></div></li><li><div class="item-name"><a class="constant" href="constant.P1_INDEX_SHIFT.html" title="constant kernel_config::memory::P1_INDEX_SHIFT">P1_INDEX_SHIFT</a></div><div class="desc docblock-short">Value: 0. Shift the Page number (not the address!) by this to get the P1 index.</div></li><li><div class="item-name"><a class="constant" href="constant.P2_INDEX_SHIFT.html" title="constant kernel_config::memory::P2_INDEX_SHIFT">P2_INDEX_SHIFT</a></div><div class="desc docblock-short">Value: 9. Shift the Page number (not the address!) by this to get the P2 index.</div></li><li><div class="item-name"><a class="constant" href="constant.P3_INDEX_SHIFT.html" title="constant kernel_config::memory::P3_INDEX_SHIFT">P3_INDEX_SHIFT</a></div><div class="desc docblock-short">Value: 18. Shift the Page number (not the address!) by this to get the P3 index.</div></li><li><div class="item-name"><a class="constant" href="constant.P4_INDEX_SHIFT.html" title="constant kernel_config::memory::P4_INDEX_SHIFT">P4_INDEX_SHIFT</a></div><div class="desc docblock-short">Value: 27. Shift the Page number (not the address!) by this to get the P4 index.</div></li><li><div class="item-name"><a class="constant" href="constant.PAGE_SHIFT.html" title="constant kernel_config::memory::PAGE_SHIFT">PAGE_SHIFT</a></div><div class="desc docblock-short">The lower 12 bits of a virtual address correspond to the P1 page frame offset. </div></li><li><div class="item-name"><a class="constant" href="constant.PAGE_SIZE.html" title="constant kernel_config::memory::PAGE_SIZE">PAGE_SIZE</a></div><div class="desc docblock-short">Page size is 4096 bytes, 4KiB pages.</div></li><li><div class="item-name"><a class="constant" href="constant.RECURSIVE_P4_INDEX.html" title="constant kernel_config::memory::RECURSIVE_P4_INDEX">RECURSIVE_P4_INDEX</a></div><div class="desc docblock-short">Value: 510. The 510th entry is used to recursively map the current P4 root page table frame
such that it can be accessed and modified just like any other level of page table.</div></li><li><div class="item-name"><a class="constant" href="constant.RECURSIVE_P4_START.html" title="constant kernel_config::memory::RECURSIVE_P4_START">RECURSIVE_P4_START</a></div><div class="desc docblock-short">The start of the virtual address range covered by the 510th P4 entry,
i.e., <a href="constant.RECURSIVE_P4_INDEX.html" title="constant kernel_config::memory::RECURSIVE_P4_INDEX"><code>RECURSIVE_P4_INDEX</code></a>;</div></li><li><div class="item-name"><a class="constant" href="constant.TEMPORARY_PAGE_VIRT_ADDR.html" title="constant kernel_config::memory::TEMPORARY_PAGE_VIRT_ADDR">TEMPORARY_PAGE_VIRT_ADDR</a></div></li><li><div class="item-name"><a class="constant" href="constant.UPCOMING_PAGE_TABLE_RECURSIVE_P4_INDEX.html" title="constant kernel_config::memory::UPCOMING_PAGE_TABLE_RECURSIVE_P4_INDEX">UPCOMING_PAGE_TABLE_RECURSIVE_P4_INDEX</a></div><div class="desc docblock-short">Value: 508. The 508th entry is used to temporarily recursively map the P4 root page table frame
of an upcoming (new) page table such that it can be accessed and modified.</div></li><li><div class="item-name"><a class="constant" href="constant.UPCOMING_PAGE_TABLE_RECURSIVE_P4_START.html" title="constant kernel_config::memory::UPCOMING_PAGE_TABLE_RECURSIVE_P4_START">UPCOMING_PAGE_TABLE_RECURSIVE_P4_START</a></div><div class="desc docblock-short">The start of the virtual address range covered by the 508th P4 entry,
i.e., <a href="constant.UPCOMING_PAGE_TABLE_RECURSIVE_P4_INDEX.html" title="constant kernel_config::memory::UPCOMING_PAGE_TABLE_RECURSIVE_P4_INDEX"><code>UPCOMING_PAGE_TABLE_RECURSIVE_P4_INDEX</code></a>;</div></li></ul></section></div></main></body></html>