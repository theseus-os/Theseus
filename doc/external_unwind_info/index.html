<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Registers and stores unwind information from external components."><title>external_unwind_info - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-f40c346f39d9abc1.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="external_unwind_info" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0-nightly (065a1f5df 2023-06-21)" data-search-js="search-95c92dd01058facf.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-190c35055d2a8300.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../external_unwind_info/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../external_unwind_info/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate external_unwind_info</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">external_unwind_info</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/external_unwind_info/lib.rs.html#1-131">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Registers and stores unwind information from external components.</p>
<p>Typically, Theseus maintains metadata about all crates loaded and linked into system.
Unwind info is part of this (the <code>.eh_frame</code> section data).</p>
<p>However, for other components compiled outside of Theseus and beyond it’s knowledge,
we don’t necessarily have control over or access to those components’ section structure
and miscellaneous internal information.
Nevertheless, we still want to be able to handle their resource management properly
by unwinding through their stack frames and running cleanup handlers as needed.</p>
<p>Hence, this crate allows those external components to register their own 
unwind information as needed.
Currently, we use this crate to support <a href="https://docs.rs/wasmtime-jit/latest/wasmtime_jit/"><code>wasmtime-jit</code></a>, which needs to 
<a href="https://github.com/bytecodealliance/wasmtime/blob/7cf5f058303d2ee8c42df658d4ca608771a8561d/crates/jit/src/code_memory.rs#L185">register unwinding information</a> for JIT-compiled native code built from WASM binaries
and then deregister it when those JIT-ted modules are destroyed.</p>
<p>The API here is loosely similar to <code>libunwind</code>’s two-part API: 
<code>__register_frame()</code> and <code>__deregister_frame()</code>.
Because it must accept raw pointers to sections, all APIs are inherently unsafe.</p>
<h3 id="future-todos"><a href="#future-todos">Future TODOs</a></h3>
<p>Currently, this crate unsafely assumes that the third party component that registers its unwind info
will ensure that unwind info is valid for the full duration of it being registered.</p>
<p>In the future, ideally we would redesign this crate to offer a safer API
that obtains shared ownership
However, that would of course require modifying the dependent crates and redesigning them
to utilize this safer API.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.ExternalUnwindInfo.html" title="struct external_unwind_info::ExternalUnwindInfo">ExternalUnwindInfo</a></div><div class="desc docblock-short">Unwinding information for an external (non-Theseus) component.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ExternalUnwindInfoError.html" title="enum external_unwind_info::ExternalUnwindInfoError">ExternalUnwindInfoError</a></div><div class="desc docblock-short">Errors that may occur when <a href="fn.register_unwind_info.html" title="fn external_unwind_info::register_unwind_info">registering</a> or [deregistering]
external unwind info.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.deregister_unwind_info.html" title="fn external_unwind_info::deregister_unwind_info">deregister_unwind_info</a><sup title="unsafe function">⚠</sup></div><div class="desc docblock-short">Remove a previously-registered section of external unwinding information.</div></li><li><div class="item-name"><a class="fn" href="fn.get_unwind_info.html" title="fn external_unwind_info::get_unwind_info">get_unwind_info</a></div><div class="desc docblock-short">Returns the registered external unwind information that covers
the given address in its text section.</div></li><li><div class="item-name"><a class="fn" href="fn.register_unwind_info.html" title="fn external_unwind_info::register_unwind_info">register_unwind_info</a><sup title="unsafe function">⚠</sup></div><div class="desc docblock-short">Register a new section of external unwinding information.</div></li></ul></section></div></main></body></html>